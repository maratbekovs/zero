<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>–ü–∞–Ω–µ–ª—å –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞ | ZERO Help Desk</title>
    <!-- iOS PWA -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="ZERO">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link rel="apple-touch-icon" sizes="57x57"   href="/icons/apple-touch-icon-57.png">
    <link rel="apple-touch-icon" sizes="60x60"   href="/icons/apple-touch-icon-60.png">
    <link rel="apple-touch-icon" sizes="72x72"   href="/icons/apple-touch-icon-72.png">
    <link rel="apple-touch-icon" sizes="76x76"   href="/icons/apple-touch-icon-76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/icons/apple-touch-icon-114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/icons/apple-touch-icon-120.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/icons/apple-touch-icon-152.png">
    <link rel="apple-touch-icon" sizes="167x167" href="/icons/apple-touch-icon-167.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/icons/apple-touch-icon-180.png">
    <link rel="manifest" href="/manifest.json">
    <link rel="stylesheet" href="/css/styles.css">
    <style>
        :root{
            --primary:#4361ee;
            --primary-600:#3a56d4;
            --danger:#e63946;
            --danger-600:#d32f2f;
            --success:#2a9d8f;
            --warning:#f4a261;

            --bg:#f4f6f9;
            --text:#2d3748;
            --muted:#718096;

            --card:#fff;
            --border:#e2e8f0;

            --radius:12px;
            --shadow:0 6px 18px rgba(0,0,0,0.08);
            --shadow-lg:0 14px 28px rgba(0,0,0,0.12);
        }

        *{box-sizing:border-box}
        html,body{height:100%}
        body{
            margin:0;
            background:var(--bg);
            color:var(--text);
            font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,sans-serif;
        }

        /* –ì–ª–æ–±–∞–ª—å–Ω—ã–π –±–∞–Ω–Ω–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–º–∏–Ω–∏–º–∞–ª—å–Ω–æ) */
        #notify-banner{
            display:none;
            position:sticky; top:0; z-index:1002;
            background:#fff3cd; color:#8a6d3b;
            border-top:1px solid #ffe8a1; border-bottom:1px solid #ffe8a1;
            padding:8px 12px; font-size:13px;
        }
        #notify-banner .actions{ display:inline-flex; gap:8px; margin-left:10px; }
        #notify-banner .btn-mini{
            background:#fff; border:1px solid var(--border); border-radius:8px; padding:6px 10px; cursor:pointer; font-size:12px;
        }

        .mobile-header{
            display:none;
            position:fixed; top:0; left:0; right:0; z-index:1002;
            background:var(--card);
            border-bottom:1px solid var(--border);
            padding:12px 16px calc(12px + env(safe-area-inset-top));
            align-items:center; justify-content:center;
        }
        .mobile-header .title{
            margin:0; font-size:16px; color:var(--primary); font-weight:700; text-align:center;
        }

        .layout{ display:flex; min-height:100vh; }
        .sidebar{
            width:280px;
            background:linear-gradient(135deg,#111827,#1f2937);
            color:#e5e7eb;
            display:flex; flex-direction:column;
            padding:20px 0;
        }
        .brand{ padding:0 24px 16px; border-bottom:1px solid rgba(255,255,255,0.08); margin-bottom:16px; }
        .brand h1{ margin:0; font-size:20px; letter-spacing:.2px; }

        .nav{ display:flex; flex-direction:column; gap:6px; padding:0 8px; }
        .nav a{
            display:flex; align-items:center; gap:12px; padding:12px 16px; margin:0 8px;
            color:#e5e7eb; text-decoration:none; border-radius:10px; transition:.2s ease;
        }
        .nav a:hover{ background:rgba(255,255,255,.06); }
        .nav a.active{ background:var(--primary); color:#fff; box-shadow:0 6px 16px rgba(67,97,238,.35); }

        .sidebar-footer{ margin-top:auto; padding:16px; border-top:1px solid rgba(255,255,255,.08); }
        .user-badge{ background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.12); border-radius:10px; padding:12px; font-size:14px; }
        .user-badge .muted{opacity:.8}

        .main{ flex:1; padding:24px; }

        .section{ display:none; }
        .section.active{ display:block; }

        .toolbar{ display:flex; align-items:center; justify-content:space-between; margin-bottom:16px; gap:12px; }

        .input, select, .date{
            background:#fff; border:1px solid var(--border);
            padding:12px 14px;
            border-radius:10px; outline:none; transition:.2s ease; font-size:14px;
        }
        .input:focus, select:focus, .date:focus{ border-color:var(--primary); box-shadow:0 0 0 3px rgba(67,97,238,.15); }

        .btn{
            background:var(--primary); color:#fff; padding:10px 14px; border:none; border-radius:10px; cursor:pointer; font-weight:600; transition:.2s ease;
        }
        .btn:hover{ background:var(--primary-600); transform:translateY(-1px); }
        .btn.secondary{ background:#e9efff; color:#1f3bb3; }
        .btn.ghost{ background:transparent; color:var(--text); border:1px solid var(--border); }
        .btn.danger{ background:var(--danger); }
        .btn.danger:hover{ background:var(--danger-600); }
        .btn.success{ background:var(--success); }
        .btn.small{ padding:8px 12px; font-size:13px; }

        .chips{ display:flex; gap:8px; flex-wrap:wrap; }
        .chip{ font-size:12px; padding:6px 10px; border-radius:999px; border:1px solid var(--border); background:#fff; cursor:default; }
        .chip.toggle{ cursor:pointer; user-select:none; }
        .chip.toggle.active{ background:var(--primary); color:#fff; border-color:var(--primary); }

        .grid{ display:grid; grid-template-columns: 1.2fr .8fr; gap:16px; }
        .card{ background:#fff; border:1px solid var(--border); border-radius:var(--radius); box-shadow:var(--shadow); }
        .card .card-header{ padding:16px 16px 0 16px; }
        .card .card-body{ padding:20px; }

        .table-wrap{ overflow:auto; border-radius:12px; }
        table{ width:100%; border-collapse:collapse; }
        th,td{ text-align:left; padding:12px; border-bottom:1px solid var(--border); font-size:14px; vertical-align:top; }
        thead th{ background:#f8fafc; position:sticky; top:0; z-index:1; }
        tr:hover td{ background:#fafcff; }

        .status{ display:inline-block; padding:6px 10px; border-radius:999px; color:#fff; font-weight:600; font-size:12px; line-height:1; }
        .s-New{ background:var(--primary); }
        /* –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∫–ª–∞—Å—Å—ã –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤ */
        .s-InProgress{ background:var(--warning); }
        .s-OnHold{ background:#7209b7; }
        .s-Successful{ background:var(--success); }
        .s-Rejected{ background:var(--danger); }
        /* –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ —Å—Ç–∞—Ä—ã–º–∏ —Å–µ–ª–µ–∫—Ç–æ—Ä–∞–º–∏ (–µ—Å–ª–∏ –≤—Å—Ç—Ä–µ—á–∞—é—Ç—Å—è) */
        .s-In\ Progress{ background:var(--warning); }
        .s-On\ Hold{ background:#7209b7; }

        /* Desktop chat panel */
        .chat{ display:flex; flex-direction:column; height:78vh; min-height:520px; }
        .chat-head{ display:flex; justify-content:space-between; align-items:flex-start; gap:8px; padding:16px; border-bottom:1px solid var(--border); }
        .chat-title{ margin:0; font-size:16px; }
        .chat-meta{ font-size:13px; color:var(--muted); }
        .chat-box{ flex:1; overflow:auto; padding:16px; display:flex; flex-direction:column; gap:10px; background:linear-gradient(180deg,#fff 0%, #fbfcff 100%); }

        .msg{ max-width:80%; padding:12px 14px; border-radius:14px; box-shadow:var(--shadow); position:relative; display:flex; flex-direction:column; gap:6px; animation:fadeIn .2s ease; }
        .msg.me{ align-self:flex-end; background:var(--primary); color:#fff; border-bottom-right-radius:6px; }
        .msg.other{ align-self:flex-start; background:#f1f5f9; color:var(--text); border-bottom-left-radius:6px; }
        .msg .meta{ font-size:12px; opacity:.8; }
        .msg .attach img, .msg .attach video{ max-width:280px; border-radius:10px; display:block; }
        /* –û—Ç—Å—Ç—É–ø—ã –∏ –ø–æ–¥–ø–∏—Å—å */
        .msg .attach{ margin:4px 8px 8px 0; display:inline-block; }
        .msg .attach .cap{ font-size:12px; color:#6c757d; margin-top:4px; }

        /* –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è –ø–∞–Ω–µ–ª—å –¥–µ–π—Å—Ç–≤–∏–π –≤ —á–∞—Ç–µ (–∫–∞–∫ –º–æ–±–∏–ª—å–Ω–∞—è) */
        .chat-actions{
            border-top:1px solid var(--border);
            padding:12px;
            display:flex;
            gap:8px;
            align-items:center;
            flex-wrap:nowrap;
            background:#fff;
        }
        .chat-actions .input{
            flex:1; min-width:0;
        }
        /* –ö–Ω–æ–ø–∫–∞ "–ø–ª—é—Å" (–≤–ª–æ–∂–µ–Ω–∏—è) ‚Äî –≤—Å–µ–≥–¥–∞ –≤–∏–¥–Ω–∞ –∏ –∫–æ–º–ø–∞–∫—Ç–Ω–∞—è */
        .dattach-toggle{
            display:flex;
            background:#fff; border:1px solid var(--border); color:var(--text);
            width:42px; height:42px; border-radius:12px; align-items:center; justify-content:center; font-size:20px; cursor:pointer;
        }
        .dattach-menu{
            position:absolute; z-index:3;
            background:#fff; border:1px solid var(--border); border-radius:12px; box-shadow:var(--shadow-lg);
            padding:8px; display:none; gap:8px; align-items:center;
        }
        .dattach-menu.open{ display:flex; }
        /* –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ ‚Äî –∫–æ–º–ø–∞–∫—Ç–Ω–∞—è –∏–∫–æ–Ω–∫–∞ */
        #chat-send-button{
            width:42px; height:42px; border-radius:12px; padding:0;
            display:flex; align-items:center; justify-content:center; font-size:18px;
        }

        .preview{ background:#f8fafc; border:1px dashed var(--border); border-radius:10px; padding:10px; display:none; gap:10px; align-items:center; }
        .preview.show{ display:flex; }
        .preview img, .preview video{ max-height:100px; border-radius:6px; }

        .banner{ background:#fff3cd; color:#8a6d3b; padding:8px 12px; font-size:13px; border-top:1px solid #ffe8a1; border-bottom:1px solid #ffe8a1; }

        /* Mobile bottom tab bar (fixed) */
        .mobile-tab-bar{
            position:fixed; left:0; right:0; bottom:0; z-index:1001;
            display:none; gap:0; align-items:center; justify-content:space-around;
            background:#fff; border-top:1px solid var(--border);
            padding:10px 6px calc(10px + env(safe-area-inset-bottom));
            box-shadow:0 -8px 16px rgba(0,0,0,.06);
        }
        .tab-item{ flex:1; text-align:center; color:var(--muted); text-decoration:none; font-size:12px; display:flex; flex-direction:column; align-items:center; gap:4px; }
        .tab-item i{ font-style:normal; font-size:18px; }
        .tab-item.active{ color:var(--primary); font-weight:600; }

        /* Mobile chat modal */
        .mchat-modal{
            display:none; position:fixed; inset:0; z-index:1003; background:rgba(0,0,0,.45);
        }
        .mchat-wrap{
            position:absolute; inset:0; background:#fff; display:flex; flex-direction:column;
        }
        .mchat-head{
            position:sticky; top:0; z-index:2; background:#f8f9fb; border-bottom:1px solid var(--border);
            display:flex; align-items:center; justify-content:space-between; gap:8px;
            padding:12px 14px calc(12px + env(safe-area-inset-top));
        }
        .mchat-title{ margin:0; font-size:16px; font-weight:700; color:var(--text); }
        .mchat-sub{ font-size:12px; color:var(--muted); }
        .mchat-close{
            background:#fff; border:1px solid var(--border); border-radius:10px; cursor:pointer;
            width:36px; height:36px; font-size:18px; color:var(--text); display:flex; align-items:center; justify-content:center;
        }
        .mchat-close:hover, .mchat-close:focus{ background:#f3f4f6; outline:none; }

        .mstatus-bar{
            display:flex; gap:8px; align-items:center;
            padding:10px 12px; border-bottom:1px solid var(--border); background:#fff;
        }
        .mstatus-info{
            padding:6px 12px 8px; color:var(--muted); font-size:12px;
        }

        .mchat-box{ flex:1; overflow:auto; padding:12px; display:flex; flex-direction:column; gap:10px; }
        .mmsg{ max-width:85%; padding:10px 12px; border-radius:14px; box-shadow:var(--shadow); display:flex; flex-direction:column; gap:6px; }
        .mmsg.me{ align-self:flex-end; background:var(--primary); color:#fff; border-bottom-right-radius:6px; }
        .mmsg.other{ align-self:flex-start; background:#f1f5f9; color:var(--text); border-bottom-left-radius:6px; }
        .mmsg .meta{ font-size:11px; opacity:.85; }
        .mmsg .attach img, .mmsg .attach video{ max-width:70vw; border-radius:10px; display:block; }
        .mmsg .attach{ margin:4px 8px 8px 0; display:inline-block; }
        .mmsg .attach .cap{ font-size:11px; color:#6c757d; margin-top:4px; }

        .mchat-actions{
            position:sticky; bottom:0; z-index:2; background:#fff; border-top:1px solid var(--border);
            padding:10px 10px calc(10px + env(safe-area-inset-bottom));
            display:flex; gap:8px; align-items:center; flex-wrap:nowrap;
        }
        .mchat-actions .input{
            flex:1; min-width:0; border-radius:22px; padding:12px 14px; font-size:15px; min-height:44px;
        }
        .mattach-toggle{
            background:#fff; border:1px solid var(--border); color:var(--text);
            width:42px; height:42px; border-radius:12px; display:flex; align-items:center; justify-content:center; font-size:20px;
        }
        #mchat-send{
            width:42px; height:42px; border-radius:12px; padding:0;
            display:flex; align-items:center; justify-content:center; font-size:18px;
        }
        .mattach-menu{
            position:absolute; bottom:62px; right:12px; z-index:3;
            background:#fff; border:1px solid var(--border); border-radius:12px; box-shadow:var(--shadow-lg);
            padding:8px; display:none; gap:8px; align-items:center;
        }
        .mattach-menu.open{ display:flex; }
        .mattach-menu .btn{ width:auto; padding:8px 10px; font-size:13px; }

        .mpreview{ background:#f8fafc; border:1px dashed var(--border); border-radius:10px; padding:8px; display:none; gap:8px; align-items:center; margin:8px 10px 10px; }
        .mpreview.show{ display:flex; }
        .mpreview img, .mpreview video{ max-height:90px; border-radius:6px; }

        /* –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –º–æ–¥–∞–ª–∫–∞ */
        .modal-overlay{
            display:none; position:fixed; inset:0; z-index:1004; background:rgba(0,0,0,.45);
            align-items:center; justify-content:center; padding:20px;
        }
        .modal-panel{
            background:#fff; border:1px solid var(--border); border-radius:14px;
            box-shadow:var(--shadow-lg); width:100%; max-width:520px; overflow:hidden;
        }
        .modal-head{
            padding:12px 16px; background:#f8f9fb; border-bottom:1px solid var(--border);
            display:flex; align-items:center; justify-content:space-between; gap:8px;
        }
        .modal-title{ margin:0; font-size:16px; font-weight:700; color:var(--text); }
        .modal-close{ background:#fff; border:1px solid var(--border); border-radius:8px; padding:6px 10px; cursor:pointer; }
        .modal-body{ padding:18px; }
        .modal-body .stack{ display:flex; flex-direction:column; gap:14px; }
        .modal-footer{ padding:12px 16px; border-top:1px solid var(--border); display:flex; gap:8px; align-items:center; justify-content:flex-end; }

        /* –õ–∞–π—Ç–±–æ–∫—Å */
        .lightbox-overlay{
            position:fixed; inset:0; background:rgba(0,0,0,.85);
            display:none; align-items:center; justify-content:center;
            z-index:1010;
        }
        .lightbox-overlay.open{ display:flex; }
        .lightbox-content{ position:relative; max-width:95vw; max-height:95vh; }
        .lightbox-img{ max-width:95vw; max-height:95vh; border-radius:8px; box-shadow:0 10px 30px rgba(0,0,0,0.4); }
        .lightbox-close{
            position:absolute; top:-10px; right:-10px; width:36px; height:36px;
            border-radius:50%; border:none; background:rgba(0,0,0,0.6); color:#fff;
            cursor:pointer; display:flex; align-items:center; justify-content:center;
            font-size:18px; line-height:1; box-shadow:0 1px 3px rgba(0,0,0,.4);
        }

        /* –°–∫—Ä—ã—Ç—å —É–ø–æ–º–∏–Ω–∞–Ω–∏—è ID */
        .ui-hide-id{ display:none !important; }

        @media (max-width: 768px){
            .mobile-header{ display:flex; }
            .sidebar{ display:none !important; }
            .main{ padding:72px 16px 96px; }
            .mobile-tab-bar{ display:flex; }
            .toolbar{ flex-direction:column; align-items:stretch; gap:10px; }
            thead th{ position:static; }
            #chat-panel{ display:none !important; }
        }
        @media (max-width: 480px){
            .main{ padding:72px 12px 98px; }
            .btn{ padding:9px 12px; font-size:13px; }
            .input, select, .date{ padding:10px 12px; font-size:13px; }
            th,td{ padding:10px; font-size:13px; }
            #tickets-table th.col-user, #tickets-table td.col-user,
            #tickets-table th.col-created, #tickets-table td.col-created { display:none; }
            #report-table th.col-moderator, #report-table td.col-moderator,
            #report-table th.col-closed, #report-table td.col-closed { display:none; }
        }
    </style>
</head>
<body>
    <!-- –ì–ª–æ–±–∞–ª—å–Ω—ã–π –±–∞–Ω–Ω–µ—Ä —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π -->
    <div id="notify-banner">
        –í–∫–ª—é—á–∏—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, —á—Ç–æ–±—ã –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å –Ω–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è.
        <span class="actions">
            <button id="nb-enable" class="btn-mini">–í–∫–ª—é—á–∏—Ç—å</button>
            <button id="nb-settings" class="btn-mini" style="display:none;">–û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            <button id="nb-close" class="btn-mini">–°–∫—Ä—ã—Ç—å</button>
        </span>
    </div>

    <div class="mobile-header">
        <h1 class="title">ZERO üõ°Ô∏è Help Desk ‚Äî –ú–æ–¥–µ—Ä–∞—Ç–æ—Ä</h1>
    </div>

    <div class="layout">
        <aside class="sidebar">
            <div class="brand"><h1>ZERO üõ°Ô∏è Help Desk</h1></div>
            <nav class="nav">
                <a href="#" class="nav-link active" data-section="tickets">üé´ –ó–∞—è–≤–∫–∏</a>
                <a href="#" class="nav-link" data-section="users">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
                <a href="#" class="nav-link" data-section="reports">üìà –û—Ç—á—ë—Ç—ã</a>
                <a href="#" class="nav-link" data-section="profile">üë§ –ü—Ä–æ—Ñ–∏–ª—å</a>
            </nav>
            <div class="sidebar-footer">
                <div class="user-badge">
                    <div><strong id="me-username">...</strong></div>
                    <div class="muted" id="me-role">—Ä–æ–ª—å: ...</div>
                </div>
                <div class="row" style="margin-top:10px;">
                    <button class="btn ghost" id="btn-logout">–í—ã–π—Ç–∏</button>
                </div>
            </div>
        </aside>

        <main class="main">
            <!-- TICKETS -->
            <section class="section active" id="sec-tickets">
                <div class="toolbar">
                    <div class="row" style="display:flex; gap:8px; flex-wrap:wrap;">
                        <input class="input" id="search" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Ç–µ–º–µ/–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é..."/>
                        <select id="filter-status" class="input">
                            <option value="">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
                            <option value="New">–ù–æ–≤—ã–µ</option>
                            <option value="In Progress">–í —Ä–∞–±–æ—Ç–µ</option>
                            <option value="On Hold">–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏</option>
                            <option value="Successful">–£—Å–ø–µ—à–Ω—ã–µ</option>
                            <option value="Rejected">–û—Ç–∫–ª–æ–Ω—ë–Ω–Ω—ã–µ</option>
                        </select>
                        <button class="btn" id="btn-reload">–û–±–Ω–æ–≤–∏—Ç—å</button>
                    </div>
                    <div class="chips">
                        <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –æ–±–ª–∞—Å—Ç–∏ -->
                        <span id="scope-all" class="chip toggle active">–í—Å–µ</span>
                        <span id="scope-my" class="chip toggle">–ú–æ–∏</span>
                        <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Å—á—ë—Ç—á–∏–∫–∏ -->
                        <span class="chip">–í—Å–µ–≥–æ: <span id="stat-total">0</span></span>
                        <span class="chip">–ù–æ–≤—ã–µ: <span id="stat-new">0</span></span>
                        <span class="chip">–í —Ä–∞–±–æ—Ç–µ: <span id="stat-ip">0</span></span>
                    </div>
                </div>

                <div class="grid">
                    <div class="card">
                        <div class="card-body">
                            <div class="table-wrap">
                                <table id="tickets-table" class="responsive">
                                    <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th class="col-user">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                                        <th>–¢–µ–º–∞</th>
                                        <th>–°—Ç–∞—Ç—É—Å</th>
                                        <th class="col-created">–°–æ–∑–¥–∞–Ω</th>
                                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                                    </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <!-- Desktop chat panel -->
                    <div class="card chat" id="chat-panel">
                        <div class="chat-head">
                            <div>
                                <h3 class="chat-title">–ß–∞—Ç: <span class="ui-hide-id" id="chat-ticket-id">‚Äî</span></h3>
                                <div class="chat-meta">
                                    –¢–µ–º–∞: <span id="chat-ticket-subject">‚Äî</span><br/>
                                    <span class="ui-hide-id">–ö–ª–∏–µ–Ω—Ç ID: <span id="chat-user-id">‚Äî</span> ‚Ä¢ </span>–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: <strong id="current-status">‚Äî</strong>
                                </div>
                            </div>
                            <div>
                                <div class="row" style="display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
                                    <select id="status-select" class="input">
                                        <option value="In Progress">–í —Ä–∞–±–æ—Ç–µ</option>
                                        <option value="On Hold">–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏</option>
                                        <option value="Successful">–£—Å–ø–µ—à–Ω–æ</option>
                                        <option value="Rejected">–û—Ç–∫–ª–æ–Ω–µ–Ω–æ</option>
                                    </select>
                                    <button class="btn success" id="update-status-button">–û–±–Ω–æ–≤–∏—Ç—å</button>
                                </div>
                                <div class="muted" id="time-spent-display" style="margin-top:6px; display:none;"></div>
                            </div>
                        </div>

                        <div id="chat-closed-banner" class="banner" style="display:none;">
                            –ß–∞—Ç –∑–∞–≤–µ—Ä—à—ë–Ω. –ù–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –Ω–µ–ª—å–∑—è ‚Äî –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–µ–ø–∏—Å–∫–∏ –∏ –≤–ª–æ–∂–µ–Ω–∏–π.
                        </div>

                        <div id="chat-box" class="chat-box"></div>

                        <div class="card-body" style="border-top:1px solid var(--border); position:relative;">
                            <div class="stack">
                                <div class="chat-actions" id="chat-actions">
                                    <input class="input" id="chat-input" placeholder="–í–∞—à –æ—Ç–≤–µ—Ç...">
                                    <input type="file" id="chat-attachment" multiple accept="image/*,video/*" style="display:none;">
                                    <!-- –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è –∫–Ω–æ–ø–∫–∞ (–≤—Å–µ–≥–¥–∞ –∫–∞–∫ –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–º) -->
                                    <button class="dattach-toggle" id="d-attach-toggle" aria-label="–í–ª–æ–∂–µ–Ω–∏—è">Ôºã</button>
                                    <div class="dattach-menu" id="d-attach-menu" role="menu" aria-hidden="true" style="right:12px; bottom:58px;">
                                        <button class="btn ghost" id="dbtn-pick">üìé –§–∞–π–ª</button>
                                        <button class="btn ghost" id="dbtn-photo">üì∑ –§–æ—Ç–æ</button>
                                        <button class="btn ghost" id="dbtn-video">üé• –í–∏–¥–µ–æ</button>
                                    </div>
                                    <!-- –ö–æ–º–ø–∞–∫—Ç–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ -->
                                    <button class="btn" id="chat-send-button" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å" aria-label="–û—Ç–ø—Ä–∞–≤–∏—Ç—å">‚û§</button>
                                </div>

                                <div class="preview" id="preview">
                                    <div id="preview-thumb"></div>
                                    <div class="row">
                                        <button class="btn ghost" id="btn-clear-preview">–£–±—Ä–∞—Ç—å</button>
                                    </div>
                                </div>
                                <div class="muted" id="chat-hint">–ü–æ–¥—Å–∫–∞–∑–∫–∞: —Å—Ç–∞—Ç—É—Å "–ù–æ–≤—ã–µ" –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–º–µ–Ω–∏—Ç—Å—è –Ω–∞ "–í —Ä–∞–±–æ—Ç–µ" –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –æ—Ç–≤–µ—Ç–µ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞.</div>
                            </div>
                        </div>
                    </div>
                    <!-- /Desktop chat panel -->
                </div>
            </section>

            <!-- USERS -->
            <section class="section" id="sec-users">
                <div class="toolbar">
                    <div class="row">
                        <button class="btn" id="btn-reload-users">–û–±–Ω–æ–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫</button>
                    </div>
                    <div class="chips">
                        <span class="chip">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: <span id="users-total">0</span></span>
                    </div>
                </div>

                <div class="grid">
                    <div class="card">
                        <div class="card-body">
                            <div class="table-wrap">
                                <table id="users-table" class="responsive">
                                    <thead>
                                    <tr>
                                        <th>–õ–æ–≥–∏–Ω</th>
<th>–§–ò–û</th>
<th class="col-phone">–¢–µ–ª–µ—Ñ–æ–Ω</th>
<th>–†–æ–ª—å</th>
<th class="col-created-users">–°–æ–∑–¥–∞–Ω</th>
<th>–î–µ–π—Å—Ç–≤–∏–µ</th>
                                    </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header"><h3>–°–æ–∑–¥–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3></div>
                        <div class="card-body">
                            <div class="stack">
                                <div class="form-grid" style="display:grid; grid-template-columns:repeat(2,1fr); gap:16px;">
                                    <input class="input" id="new-username" placeholder="–õ–æ–≥–∏–Ω" />
                                    <input class="input" id="new-password" placeholder="–ü–∞—Ä–æ–ª—å" type="password" />
                                    <input class="input" id="new-fullname" placeholder="–§–ò–û" />
                                    <input class="input" id="new-phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" />
                                    <select id="new-role" class="input">
                                        <option value="user">user</option>
                                        <option value="moderator">moderator</option>
                                    </select>
                                    <div class="row" style="grid-column:1/-1; gap:12px;">
                                        <button class="btn" id="btn-create-user">–°–æ–∑–¥–∞—Ç—å</button>
                                        <div class="muted" id="create-user-msg"></div>
                                    </div>
                                </div>
                                <div class="muted">–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: —Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –ø—Ä–∞–≤–∞–º–∏.</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- REPORTS -->
            <section class="section" id="sec-reports">
                <div class="toolbar">
                    <div class="row" style="display:flex; gap:8px; flex-wrap:wrap;">
                        <button class="btn" id="btn-archive" onclick="window.location.href='/moder-archive.html'">–ê—Ä—Ö–∏–≤ –∑–∞–≤–µ—Ä—à—ë–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫</button>
                        <input type="date" class="date" id="start_date" />
                        <input type="date" class="date" id="end_date" />
                        <button class="btn" id="btn-make-report">–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å</button>
                        <button class="btn ghost" id="btn-print" disabled>–ü–µ—á–∞—Ç—å</button>
                    </div>
                </div>

                <div class="grid">
                    <div class="card">
                        <div class="card-header"><h3>–°–≤–æ–¥–∫–∞</h3></div>
                        <div class="card-body" id="report-summary">
                            <div class="muted">–£–∫–∞–∂–∏—Ç–µ –ø–µ—Ä–∏–æ–¥ –∏ –Ω–∞–∂–º–∏—Ç–µ "–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å".</div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header"><h3>–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è</h3></div>
                        <div class="card-body">
                            <div class="table-wrap">
                                <table id="report-table" class="responsive">
                                    <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>–¢–µ–º–∞</th>
                                        <th>–°—Ç–∞—Ç—É—Å</th>
                                        <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                                        <th class="col-moderator">–ú–æ–¥–µ—Ä–∞—Ç–æ—Ä</th>
                                        <th>–°–æ–∑–¥–∞–Ω</th>
                                        <th class="col-closed">–ó–∞–∫—Ä—ã—Ç</th>
                                    </tr>
                                    </thead>
                                    <tbody></tbody>
                                </table>
                            </div>
                            <div class="muted" id="report-message"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- PROFILE -->
            <section class="section" id="sec-profile">
                <div class="card">
                    <div class="card-body">
                        <h3>–ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å</h3>

                        <div class="row" style="align-items:center; gap:10px; margin:8px 0 6px;">
                            <img id="profile-avatar" alt="–ê–≤–∞—Ç–∞—Ä" src="/icons/user-placeholder.png" style="width:72px;height:72px;border-radius:50%;object-fit:cover;">
                            <div class="muted">
                                <div>–§–ò–û: <strong id="profile-fullname">‚Äî</strong></div>
                                <div>–¢–µ–ª–µ—Ñ–æ–Ω: <strong id="profile-phone">‚Äî</strong></div>
                            </div>
                        </div>

                        <p class="muted">–í—ã –≤–æ—à–ª–∏ –∫–∞–∫: <strong id="profile-username">‚Äî</strong> (<span id="profile-role">‚Äî</span>)</p>

                        <div class="row" style="gap:8px; flex-wrap:wrap;">
                            <button class="btn" id="profile-edit-toggle">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
                            <button class="btn success" id="profile-save" style="display:none;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                            <button class="btn ghost" id="profile-cancel" style="display:none;">–û—Ç–º–µ–Ω–∞</button>
                            <button class="btn danger" id="logout-2">–í—ã–π—Ç–∏</button>
                        </div>

                        <div id="profile-edit-panel" style="display:none; margin-top:14px;">
                            <div class="stack" style="gap:10px;">
                                <input id="prof-fullname" class="input" type="text" placeholder="–§–ò–û">
                                <input id="prof-phone" class="input" type="text" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω">
                                <div class="row" style="gap:8px; align-items:center; flex-wrap:wrap;">
                                    <input type="file" id="prof-avatar" accept="image/*" style="display:none;">
                                    <button class="btn ghost" id="prof-avatar-pick">–í—ã–±—Ä–∞—Ç—å –∞–≤–∞—Ç–∞—Ä</button>
                                    <span class="muted" id="prof-avatar-msg"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Fixed mobile tabs -->
    <div class="mobile-tab-bar" id="mobile-tab-bar">
        <a href="#" class="tab-item active" data-section="tickets"><i>üé´</i><span>–ó–∞—è–≤–∫–∏</span></a>
        <a href="#" class="tab-item" data-section="users"><i>üë•</i><span>–ü–æ–ª—å–∑.</span></a>
        <a href="#" class="tab-item" data-section="reports"><i>üìà</i><span>–û—Ç—á—ë—Ç—ã</span></a>
        <a href="#" class="tab-item" data-section="profile"><i>üë§</i><span>–ü—Ä–æ—Ñ–∏–ª—å</span></a>
    </div>

    <!-- Mobile chat modal -->
    <div class="mchat-modal" id="mchat-modal">
        <div class="mchat-wrap">
            <div class="mchat-head">
                <div>
                    <h3 class="mchat-title">–ß–∞—Ç <span class="ui-hide-id">#<span id="mchat-ticket-id">‚Äî</span></span></h3>
                    <div class="mchat-sub">–¢–µ–º–∞: <span id="mchat-ticket-subject">‚Äî</span> ‚Ä¢ –°—Ç–∞—Ç—É—Å: <strong id="mchat-status">‚Äî</strong></div>
                </div>
                <button class="mchat-close" id="mchat-close" aria-label="–ó–∞–∫—Ä—ã—Ç—å —á–∞—Ç">‚úï</button>
            </div>

            <div id="mchat-closed-banner" class="banner" style="display:none;">
                –ß–∞—Ç –∑–∞–≤–µ—Ä—à—ë–Ω. –ù–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –Ω–µ–ª—å–∑—è ‚Äî –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–µ–ø–∏—Å–∫–∏ –∏ –≤–ª–æ–∂–µ–Ω–∏–π.
            </div>

            <div class="mstatus-bar">
                <select id="mstatus-select" class="input">
                    <option value="In Progress">–í —Ä–∞–±–æ—Ç–µ</option>
                    <option value="On Hold">–ù–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–∏</option>
                    <option value="Successful">–£—Å–ø–µ—à–Ω–æ</option>
                    <option value="Rejected">–û—Ç–∫–ª–æ–Ω–µ–Ω–æ</option>
                </select>
                <button class="btn" id="mupdate-status-button">–û–±–Ω–æ–≤–∏—Ç—å</button>
            </div>
            <div class="mstatus-info" id="mtime-spent-display" style="display:none;"></div>

            <div id="mchat-box" class="mchat-box"></div>

            <div class="mchat-actions" id="mchat-actions">
                <input class="input" id="mchat-input" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ" />
                <input type="file" id="mchat-attachment" multiple accept="image/*,video/*" style="display:none;">
                <button class="mattach-toggle" id="mattach-toggle" aria-label="–í–ª–æ–∂–µ–Ω–∏—è">Ôºã</button>
                <button class="btn" id="mchat-send" title="–û—Ç–ø—Ä–∞–≤–∏—Ç—å" aria-label="–û—Ç–ø—Ä–∞–≤–∏—Ç—å">‚û§</button>

                <div class="mattach-menu" id="mattach-menu" role="menu" aria-hidden="true">
                    <button class="btn ghost" id="mbtn-pick">üìé –§–∞–π–ª</button>
                    <button class="btn ghost" id="mbtn-photo">üì∑ –§–æ—Ç–æ</button>
                    <button class="btn ghost" id="mbtn-video">üé• –í–∏–¥–µ–æ</button>
                </div>
            </div>

            <div class="mpreview" id="mpreview">
                <div id="mpreview-thumb"></div>
                <button class="btn ghost" id="mbtn-clear-preview">–£–±—Ä–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª–∫–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è -->
    <div class="modal-overlay" id="edit-user-modal" aria-hidden="true">
        <div class="modal-panel" role="dialog" aria-modal="true" aria-labelledby="edit-user-title">
            <div class="modal-head">
                <h3 class="modal-title" id="edit-user-title">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>
                <button class="modal-close" id="edit-user-close" aria-label="–ó–∞–∫—Ä—ã—Ç—å">‚úï</button>
            </div>
            <div class="modal-body">
                <div id="edit-user-message" class="muted"></div>
                <div class="stack">
                    <div>
                        <label for="edit-user-username" class="muted" style="display:block; margin-bottom:6px;">–õ–æ–≥–∏–Ω (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ)</label>
                        <input id="edit-user-username" class="input" type="text" disabled>
                    </div>
                    <div>
                        <label for="edit-user-fullname" style="display:block; margin-bottom:6px;">–§–ò–û</label>
                        <input id="edit-user-fullname" class="input" type="text" placeholder="–í–≤–µ–¥–∏—Ç–µ –§–ò–û">
                    </div>
                    <div>
                        <label for="edit-user-phone" style="display:block; margin-bottom:6px;">–¢–µ–ª–µ—Ñ–æ–Ω</label>
                        <input id="edit-user-phone" class="input" type="text" placeholder="+7 ...">
                    </div>
                    <div>
                        <label for="edit-user-role" class="muted" style="display:block; margin-bottom:6px;">–†–æ–ª—å (—Ç–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ)</label>
                        <input id="edit-user-role" class="input" type="text" disabled>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn ghost" id="edit-user-cancel">–û—Ç–º–µ–Ω–∞</button>
                <button class="btn" id="edit-user-save">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- –õ–æ–∫–∞–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç Socket.IO -->
    <script src="/socket.io/socket.io.js"></script>
    <script defer src="/js/moder.js"></script>

    <!-- –õ–∞–π—Ç–±–æ–∫—Å -->
    <div id="lightbox" class="lightbox-overlay" aria-hidden="true">
        <div class="lightbox-content">
            <img id="lightbox-img" class="lightbox-img" alt="–ü—Ä–æ—Å–º–æ—Ç—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è">
            <button id="lightbox-close" class="lightbox-close" aria-label="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
        </div>
    </div>
</body>
</html>